YUI.add("calendar",function(e,t){function a(e){a.superclass.constructor.apply(this,arguments)}var i=e.ClassNameManager.getClassName,s=(i("calendar","header"),i("calendar","day-selected")),l=i("calendar","day-highlighted"),h=i("calendar","day"),n=i("calendar","prevmonth-day"),d=i("calendar","nextmonth-day"),r=i("calendar","grid"),o=e.DataType.Date,c=(e.delegate,i("calendar","pane")),u=e.UA.os;e.Calendar=e.extend(a,e.CalendarBase,{_keyEvents:[],_highlightedDateNode:null,_lastSelectedDate:null,initializer:function(){this.plug(e.Plugin.CalendarNavigator),this._keyEvents=[],this._highlightedDateNode=null,this._lastSelectedDate=null},_bindCalendarEvents:function(){var e=this.get("contentBox"),t=e.one("."+c);t.on("selectstart",this._preventSelectionStart),t.delegate("click",this._clickCalendar,"."+h+", ."+n+", ."+d,this),t.delegate("keydown",this._keydownCalendar,"."+r,this),t.delegate("focus",this._focusCalendarGrid,"."+r,this),t.delegate("focus",this._focusCalendarCell,"."+h,this),t.delegate("blur",this._blurCalendarGrid,"."+r+",."+h,this)},_preventSelectionStart:function(e){e.preventDefault()},_highlightDateNode:function(e){this._unhighlightCurrentDateNode();var t=this._dateToNode(e);t.focus(),t.addClass(l)},_unhighlightCurrentDateNode:function(){var e=this.get("contentBox").all("."+l);e&&e.removeClass(l)},_getGridNumber:function(e){var t=e.get("id").split("_").reverse();return parseInt(t[0],10)},_blurCalendarGrid:function(e){this._unhighlightCurrentDateNode()},_focusCalendarCell:function(e){this._highlightedDateNode=e.target,e.stopPropagation()},_focusCalendarGrid:function(e){this._unhighlightCurrentDateNode(),this._highlightedDateNode=null},_keydownCalendar:function(e){var t=this._getGridNumber(e.target),a=this._highlightedDateNode?this._nodeToDate(this._highlightedDateNode):null,i=e.keyCode,l=0;switch(i){case 40:l=7,"s";break;case 38:l=-7,"n";break;case 37:l=-1,"w";break;case 39:l=1,"e";break;case 32:case 13:if(e.preventDefault(),this._highlightedDateNode){var h=this.get("selectionMode");"single"!==h||this._highlightedDateNode.hasClass(s)?"multiple"!==h&&"multiple-sticky"!==h||(this._highlightedDateNode.hasClass(s)?this._removeDateFromSelection(a):this._addDateToSelection(a)):(this._clearSelection(!0),this._addDateToSelection(a))}}if(40==i||38==i||37==i||39==i){a||(a=o.addMonths(this.get("date"),t),l=0),e.preventDefault();var n=o.addDays(a,l),d=this.get("date"),r=o.addMonths(this.get("date"),this._paneNumber-1),c=new Date(r);r.setDate(o.daysInMonth(r)),o.isInRange(n,d,r)?this._highlightDateNode(n):o.isGreater(d,n)?o.isGreaterOrEqual(this.get("minimumDate"),d)||(this.set("date",o.addMonths(d,-1)),this._highlightDateNode(n)):o.isGreater(n,r)&&(o.isGreaterOrEqual(c,this.get("maximumDate"))||(this.set("date",o.addMonths(d,1)),this._highlightDateNode(n)))}},_clickCalendar:function(e){var t=e.currentTarget,a=t.hasClass(h)&&!t.hasClass(n)&&!t.hasClass(d),i=t.hasClass(s);switch(this.get("selectionMode")){case"single":a&&(i||(this._clearSelection(!0),this._addDateToSelection(this._nodeToDate(t))));break;case"multiple-sticky":a&&(i?this._removeDateFromSelection(this._nodeToDate(t)):this._addDateToSelection(this._nodeToDate(t)));break;case"multiple":if(a)if(e.metaKey||e.ctrlKey||e.shiftKey){if(("macintosh"==u&&e.metaKey||"macintosh"!=u&&e.ctrlKey)&&!e.shiftKey)i?(this._removeDateFromSelection(this._nodeToDate(t)),this._lastSelectedDate=null):(this._lastSelectedDate=this._nodeToDate(t),this._addDateToSelection(this._lastSelectedDate));else if(("macintosh"==u&&e.metaKey||"macintosh"!=u&&e.ctrlKey)&&e.shiftKey)if(this._lastSelectedDate){var l=this._nodeToDate(t);this._addDateRangeToSelection(l,this._lastSelectedDate),this._lastSelectedDate=l}else this._lastSelectedDate=this._nodeToDate(t),this._addDateToSelection(this._lastSelectedDate);else if(e.shiftKey)if(this._lastSelectedDate){var l=this._nodeToDate(t);this._clearSelection(!0),this._addDateRangeToSelection(l,this._lastSelectedDate),this._lastSelectedDate=l}else this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(t),this._addDateToSelection(this._lastSelectedDate)}else this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(t),this._addDateToSelection(this._lastSelectedDate)}a?this.fire("dateClick",{cell:t,date:this._nodeToDate(t)}):t.hasClass(n)?this.fire("prevMonthClick"):t.hasClass(d)&&this.fire("nextMonthClick")},subtractMonth:function(e){this.set("date",o.addMonths(this.get("date"),-1)),e&&e.halt()},subtractYear:function(e){this.set("date",o.addYears(this.get("date"),-1)),e&&e.halt()},addMonth:function(e){this.set("date",o.addMonths(this.get("date"),1)),e&&e.halt()},addYear:function(e){this.set("date",o.addYears(this.get("date"),1)),e&&e.halt()}},{NAME:"calendar",ATTRS:{selectionMode:{value:"single"},date:{value:new Date,lazyAdd:!1,setter:function(e){var t=this._normalizeDate(e),a=o.addMonths(t,this._paneNumber-1),i=this.get("minimumDate"),s=this.get("maximumDate");if(!(i&&!o.isGreaterOrEqual(t,i)||s&&!o.isGreaterOrEqual(s,a)))return t;if(i&&o.isGreater(i,t))return i;if(s&&o.isGreater(a,s)){return o.addMonths(s,-1*(this._paneNumber-1))}}},minimumDate:{value:null,setter:function(e){if(e){var t=this.get("date"),a=this._normalizeDate(e);return t&&!o.isGreaterOrEqual(t,a)&&this.set("date",a),a}return this._normalizeDate(e)}},maximumDate:{value:null,setter:function(e){if(e){var t=this.get("date"),a=this._normalizeDate(e);return t&&!o.isGreaterOrEqual(e,o.addMonths(t,this._paneNumber-1))&&this.set("date",o.addMonths(a,-1*(this._paneNumber-1))),a}return e}}}})},"@VERSION@",{requires:["calendar-base","calendarnavigator"],lang:["de","en","fr","ja","nb-NO","pt-BR","ru","zh-HANT-TW"],skinnable:!0});
