YUI.add("calendar",function(e,t){function a(e){a.superclass.constructor.apply(this,arguments)}var i=e.ClassNameManager.getClassName,s="calendar",h=(i(s,"header"),i(s,"day-selected")),l=i(s,"day-highlighted"),n=i(s,"day"),d=i(s,"prevmonth-day"),r=i(s,"nextmonth-day"),o=i(s,"grid"),c=e.DataType.Date,u=(e.delegate,i(s,"pane")),_=e.UA.os;e.Calendar=e.extend(a,e.CalendarBase,{_keyEvents:[],_highlightedDateNode:null,_lastSelectedDate:null,initializer:function(){this.plug(e.Plugin.CalendarNavigator),this._keyEvents=[],this._highlightedDateNode=null,this._lastSelectedDate=null},_bindCalendarEvents:function(){var e=this.get("contentBox").one("."+u);e.on("selectstart",this._preventSelectionStart),e.delegate("click",this._clickCalendar,"."+n+", ."+d+", ."+r,this),e.delegate("keydown",this._keydownCalendar,"."+o,this),e.delegate("focus",this._focusCalendarGrid,"."+o,this),e.delegate("focus",this._focusCalendarCell,"."+n,this),e.delegate("blur",this._blurCalendarGrid,"."+o+",."+n,this)},_preventSelectionStart:function(e){e.preventDefault()},_highlightDateNode:function(e){this._unhighlightCurrentDateNode();var t=this._dateToNode(e);t.focus(),t.addClass(l)},_unhighlightCurrentDateNode:function(){var e=this.get("contentBox").all("."+l);e&&e.removeClass(l)},_getGridNumber:function(e){var t=e.get("id").split("_").reverse();return parseInt(t[0],10)},_blurCalendarGrid:function(e){this._unhighlightCurrentDateNode()},_focusCalendarCell:function(e){this._highlightedDateNode=e.target,e.stopPropagation()},_focusCalendarGrid:function(e){this._unhighlightCurrentDateNode(),this._highlightedDateNode=null},_keydownCalendar:function(e){var t,a,i,s,l,n=this._getGridNumber(e.target),d=this._highlightedDateNode?this._nodeToDate(this._highlightedDateNode):null,r=e.keyCode,o=0;switch(r){case 40:o=7,"s";break;case 38:o=-7,"n";break;case 37:o=-1,"w";break;case 39:o=1,"e";break;case 32:case 13:e.preventDefault(),this._highlightedDateNode&&("single"!==(t=this.get("selectionMode"))||this._highlightedDateNode.hasClass(h)?"multiple"!==t&&"multiple-sticky"!==t||(this._highlightedDateNode.hasClass(h)?this._removeDateFromSelection(d):this._addDateToSelection(d)):(this._clearSelection(!0),this._addDateToSelection(d)))}40!=r&&38!=r&&37!=r&&39!=r||(d||(d=c.addMonths(this.get("date"),n),o=0),e.preventDefault(),a=c.addDays(d,o),i=this.get("date"),s=c.addMonths(this.get("date"),this._paneNumber-1),l=new Date(s),s.setDate(c.daysInMonth(s)),c.isInRange(a,i,s)?this._highlightDateNode(a):c.isGreater(i,a)?c.isGreaterOrEqual(this.get("minimumDate"),i)||(this.set("date",c.addMonths(i,-1)),this._highlightDateNode(a)):c.isGreater(a,s)&&(c.isGreaterOrEqual(l,this.get("maximumDate"))||(this.set("date",c.addMonths(i,1)),this._highlightDateNode(a))))},_clickCalendar:function(e){var t,a=e.currentTarget,i=a.hasClass(n)&&!a.hasClass(d)&&!a.hasClass(r),s=a.hasClass(h);switch(this.get("selectionMode")){case"single":i&&(s||(this._clearSelection(!0),this._addDateToSelection(this._nodeToDate(a))));break;case"multiple-sticky":i&&(s?this._removeDateFromSelection(this._nodeToDate(a)):this._addDateToSelection(this._nodeToDate(a)));break;case"multiple":i&&(e.metaKey||e.ctrlKey||e.shiftKey?("macintosh"==_&&e.metaKey||"macintosh"!=_&&e.ctrlKey)&&!e.shiftKey?s?(this._removeDateFromSelection(this._nodeToDate(a)),this._lastSelectedDate=null):(this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate)):("macintosh"==_&&e.metaKey||"macintosh"!=_&&e.ctrlKey)&&e.shiftKey?this._lastSelectedDate?(t=this._nodeToDate(a),this._addDateRangeToSelection(t,this._lastSelectedDate),this._lastSelectedDate=t):(this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate)):e.shiftKey&&(this._lastSelectedDate?(t=this._nodeToDate(a),this._clearSelection(!0),this._addDateRangeToSelection(t,this._lastSelectedDate),this._lastSelectedDate=t):(this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate))):(this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate)))}i?this.fire("dateClick",{cell:a,date:this._nodeToDate(a)}):a.hasClass(d)?this.fire("prevMonthClick"):a.hasClass(r)&&this.fire("nextMonthClick")},subtractMonth:function(e){this.set("date",c.addMonths(this.get("date"),-1)),e&&e.halt()},subtractYear:function(e){this.set("date",c.addYears(this.get("date"),-1)),e&&e.halt()},addMonth:function(e){this.set("date",c.addMonths(this.get("date"),1)),e&&e.halt()},addYear:function(e){this.set("date",c.addYears(this.get("date"),1)),e&&e.halt()}},{NAME:"calendar",ATTRS:{selectionMode:{value:"single"},date:{value:new Date,lazyAdd:!1,setter:function(e){var t=this._normalizeDate(e),a=c.addMonths(t,this._paneNumber-1),i=this.get("minimumDate"),s=this.get("maximumDate");return i&&!c.isGreaterOrEqual(t,i)||s&&!c.isGreaterOrEqual(s,a)?i&&c.isGreater(i,t)?i:s&&c.isGreater(a,s)?c.addMonths(s,-1*(this._paneNumber-1)):void 0:t}},minimumDate:{value:null,setter:function(e){if(e){var t=this.get("date"),a=this._normalizeDate(e);return t&&!c.isGreaterOrEqual(t,a)&&this.set("date",a),a}return this._normalizeDate(e)}},maximumDate:{value:null,setter:function(e){if(e){var t=this.get("date"),a=this._normalizeDate(e);return t&&!c.isGreaterOrEqual(e,c.addMonths(t,this._paneNumber-1))&&this.set("date",c.addMonths(a,-1*(this._paneNumber-1))),a}return e}}}})},"@VERSION@",{requires:["calendar-base","calendarnavigator"],lang:["de","en","fr","ja","nb-NO","pt-BR","ru","zh-HANT-TW"],skinnable:!0});